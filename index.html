<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>Hello World!</title>
    <!-- https://electronjs.org/docs/tutorial/security#csp-meta-tag -->
    <meta http-equiv="Content-Security-Policy" content="script-src 'self' 'unsafe-inline';" />
  </head>
  <body>
    <img id="image" class="display: none" />
    <input id="fileinput" accept="image/jpeg, image/png" type="file" />
    <div id="recognize" style="white-space: pre-line"></div>
    <script>
      const image = document.getElementById("image")
      const fileinput = document.getElementById("fileinput")
      const recognize = document.getElementById("recognize")

      const changeHandle = async (event) => {
        const file = event.target?.files?.[0]
        if (!file) return
        const path = file.path
        if (path) {
          image.src = path
          image.style.display = "block"
          image.style.height = "200px"
          image.style.border = "1px solid"
        }
        recognize.innerText = `file path:\n${path}\n\nresult:\nloading...`
        const json = await window.electronAPI.recognize(path)
        const result = JSON.parse(json)

        console.log("file path:")
        console.log(path)
        console.log("result:")
        console.log(result?.data?.text)
        recognize.innerText = `file path:\n${path}\n\nresult:\n${result?.data?.text}`
      }
      fileinput.addEventListener("change", changeHandle)
    </script>
  </body>
</html>
